<!DOCTYPE html>
<html lang="en" xmlns:th="www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <link rel="shortcut icon" href="data:image/x-icon;," type="image/x-icon">
  <!--    Google Fonts-->
  <!-- <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700,800' rel='stylesheet' type='text/css'> -->
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@500&display=swap" rel="stylesheet">
  <!-- Bootstrap -->
  <link href="css/bootstrap.min.css" rel="stylesheet">

  <!--Main Stylesheet-->
  <link href="css/style.css" rel="stylesheet">

  <!-- summnerNote -->
  <!--  jQuery, bootstrap -->
  <link href="http://netdna.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.css" rel="stylesheet">
  <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.js"></script>
  <script src="http://netdna.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.js"></script>

  <!-- summernote css/js-->
  <link href="http://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.8/summernote.css" rel="stylesheet">
  <script src="http://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.8/summernote.js"></script>

  <title>CMIC</title>
  <!-- include libraries(jQuery, bootstrap) -->
  <style>
        .infoTable{
            margin: 0 auto;
        }
        .infoTable th{
            background-color: #D9D9D9;
        }
        .infoTable th,tr {

            border: 1px solid #D9D9D9;
            border-collapse: collapse;
        }
        .infoTable thead, tfoot{
            text-align:center;
        }

        #info_div{
	        width: 700px;

        }
        .infoListButton{
            text-decoration: none;
        }
        #infoOne_btn{
            margin: 0 auto;
        }

        #title_ip {
          width:700px
        }

    </style>
</head>
<body>
<!--Start Hedaer Section-->
<section id="header">
  <div class="header-area">
    <div class="top_header">
      <div class="container">
        <div class="row">
          <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 zero_mp">
            <div class="address">
            </div>
          </div>
          <!--End of col-md-4-->
          <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 zero_mp">
            <div class="phone">
            </div>
          </div>
          <!--End of col-md-4-->
          <div class="col-md-4">
            <div class="social_icon text-right">
              <button>login</button>
            </div>
          </div>
          <!--End of col-md-4-->
        </div>
        <!--End of row-->
      </div>
      <!--End of container-->
    </div>
    <!--End of top header-->
    <div class="header_menu text-center" data-spy="affix" data-offset-top="50" id="nav">
      <div class="container">
        <nav class="navbar navbar-default zero_mp ">
          <!-- Brand and toggle get grouped for better mobile display -->
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand custom_navbar-brand" href="#"><img src="img/logo.png" alt=""></a>
          </div>
          <!--End of navbar-header-->

          <!-- Collect the nav links, forms, and other content for toggling -->
          <div class="collapse navbar-collapse zero_mp" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right main_menu">
              <li class="active"><a href="#header"> <span class="sr-only">(current)</span></a></li>
              <li><a href="#testimonial">환경퀴즈</a></li>
              <li><a href="#blog">챌린지</a></li>
              <li><a href="#contact">환경정보</a></li>
            </ul>
          </div>
          <!-- /.navbar-collapse -->
        </nav>
        <!--End of nav-->
      </div>
      <!--End of container-->
    </div>
    <!--End of header menu-->
  </div>
  <!--end of header area-->
</section>
<!--End of Hedaer Section-->


  <div id="infoOne">
    <form id="carbonInfoMody" action="/carbonInfo/carbonInfoModifySelect/run" method="post">
      <table class="infoTable">
        <thead>
        <tr>
          <th width="100" height="35" style="text-align: center;">제목</th>
          <td colspan="3" height="35" ><input id="title_ip" type="text" name="infoTitle" maxlength="30"
                                              th:value="${carbonInfo.infoTitle}"
                                              placeholder="제목을 입력해주세요."></td>
        </tr>
        <tr>
          <th width="100" height="35" style="text-align: center;">작성일</th>
          <td width="350" height="35" th:text="${carbonInfo.infoDate}" name="infoDate"></td>
          <th width="100" height="35" style="text-align: center;" >조회수</th>
          <td width="350" height="35" th:text="${carbonInfo.infoDate}" name="infoView"></td>
        </tr>
        <tr>
          <th width="100" height="35" style="text-align: center;">출처</th>
          <td width="350" height="35"><input type="text" name="infoSource" maxlength="20"
                                        placeholder="출처를 입력해주세요." th:value="${carbonInfo.infoSource}"></td>
          <th width="100" height="35" style="text-align: center;">작성자</th>
          <td width="350" height="35" name="adminJob" th:text="${carbonInfo.admin.adminJob}"></td>
        </tr>
        </thead>
        <tbody>
        <tr>
          <td colspan="4">
            <textarea class="summernote" name="infoContent"
                                         th:value="${carbonInfo.infoContent}"
                                         th:utext="${carbonInfo.infoContent}">

            </textarea>
          </td>
        </tr>
        <tr>
          <th width="100" height="35" style="text-align: center;">첨부파일</th>
          <td colspan="3">
                    <th:block th:if="${carbonInfo.carbonInfoFileList.infoFileName}">

                      <a id="uploadFile" th:href="@{'/'+${carbonInfo.carbonInfoFileList.infoFileName}}">
                        [[${carbonInfo.carbonInfoFileList.infoFileName}]]</a>
                      <button type="button" id="deleteX" >x</button>

                      <input type="hidden" name="infoFileName" value="${carbonInfo.carbonInfoFileList.infoFileName}">
                      <input type="hidden" name="infoFileName" value="${carbonInfo.carbonInfoFileList.infoFilePath}">

                    </th:block>
                    <input style="display:none" id="uploadingFile" name="file" type="file">
          </td>
        </tr>
        </tbody>
      </table>
      <input type="hidden" name="infoNo" th:value="${carbonInfo.infoNo}" >
      <input type="hidden" id="status2" value="modi">
      <input type="hidden" name="status" value="modify">

      <button id="infoModifyRun" type="submit" >수정</button>
    </form>
  </div>
  <div id="fileDeleteDiv" style="display:none">
    <input id="deleteFileName" th:value="${carbonInfo.carbonInfoFileList.infoFileName}">
    <input id="fileDeleteInfoNo" th:value="${carbonInfo.infoNo}">
  </div>


  <script>

  $("#deleteX").click(function(){
    $("#status").val('delete');
    $("#uploadFile").hide();
    $("#deleteX").hide();
    $("#uploadingFile").show();
  })

  $("#uploadingFile").click(function(){
    $("#status2").val('uploading');
  })

  $("#infoModifyRun").click(function(){

  		if(confirm("해당 게시글을 수정 하시겠습니까?") == true){

            $("#carbonInfoMody").submit();

			}else{
				return false;
			}
        });

  $('.summernote').summernote({
        height: 150,
        lang: "ko-KR"
      });

      $('#summernote').summernote({
		height: 300,
		width : 1000,
		minHeight: 500,
		maxHeight: null,
		focus: true,
		lang: "ko-KR",
		callbacks: {
			onImageUpload : function(files){
				updateFile(files[0],this);
			}
		}

	});

	function updateFile(file, editor){
		var data = new FormData();
		data.append("file", file);
		console.log(file);
		$.ajax({
			data : data,
			type : "POST",
			url : "SummerNoteImageFile",
			contentType : false,
			processData : false,
			success : function(data){
				console.log(data);
				console.log(editor);
				$(editor).summernote("insertImage",data.url);
			}
		});
	}

  </script>
</body>
</html>